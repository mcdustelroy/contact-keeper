{"ast":null,"code":"import _asyncToGenerator from\"/Users/dustinmcelroy/Desktop/Programming/Projects/contact-keeper/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/dustinmcelroy/Desktop/Programming/Projects/contact-keeper/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/dustinmcelroy/Desktop/Programming/Projects/contact-keeper/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useReducer}from\"react\";import axios from\"axios\";import AuthContext from\"./authContext\";import authReducer from\"./authReducer\";import setAuthToken from\"../../utils/setAuthToken\";import{REGISTER_SUCCESS,REGISTER_FAIL,USER_LOADED,AUTH_ERROR,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT,CLEAR_ERRORS}from\"../types\";import{jsx as _jsx}from\"react/jsx-runtime\";var AuthState=function AuthState(props){var initialState={token:localStorage.getItem(\"token\"),isAuthenticated:null,loading:true,user:null,error:null};var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// Load User\nvar loadUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);}_context.prev=1;_context.next=4;return axios.get(\"/api/auth\");case 4:res=_context.sent;dispatch({type:USER_LOADED,payload:res.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:AUTH_ERROR});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function loadUser(){return _ref.apply(this,arguments);};}();// Register User\nvar register=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(formData){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context2.prev=1;_context2.next=4;return axios.post(\"/api/users\",formData,config);case 4:res=_context2.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});loadUser();_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch({type:REGISTER_FAIL,payload:_context2.t0.response.data.msg});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function register(_x){return _ref2.apply(this,arguments);};}();// Login User\nvar login=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(formData){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context3.prev=1;_context3.next=4;return axios.post(\"/api/auth\",formData,config);case 4:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});loadUser();_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);dispatch({type:LOGIN_FAIL,payload:_context3.t0.response.data.msg});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function login(_x2){return _ref3.apply(this,arguments);};}();// Logout\nvar logout=function logout(){dispatch({type:LOGOUT});};// Clear Errors\nvar clearErrors=function clearErrors(){dispatch({type:CLEAR_ERRORS});};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{token:state.token,isAuthenticated:state.isAuthenticated,loading:state.loading,user:state.user,error:state.error,register:register,loadUser:loadUser,login:login,logout:logout,clearErrors:clearErrors},children:props.children});};export default AuthState;","map":{"version":3,"sources":["/Users/dustinmcelroy/Desktop/Programming/Projects/contact-keeper/client/src/context/auth/AuthState.js"],"names":["React","useReducer","axios","AuthContext","authReducer","setAuthToken","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","CLEAR_ERRORS","AuthState","props","initialState","token","localStorage","getItem","isAuthenticated","loading","user","error","state","dispatch","loadUser","get","res","type","payload","data","register","formData","config","headers","post","response","msg","login","logout","clearErrors","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from \"react\";\nimport axios from \"axios\";\nimport AuthContext from \"./authContext\";\nimport authReducer from \"./authReducer\";\nimport setAuthToken from \"../../utils/setAuthToken\";\nimport {\n\tREGISTER_SUCCESS,\n\tREGISTER_FAIL,\n\tUSER_LOADED,\n\tAUTH_ERROR,\n\tLOGIN_SUCCESS,\n\tLOGIN_FAIL,\n\tLOGOUT,\n\tCLEAR_ERRORS,\n} from \"../types\";\n\nconst AuthState = (props) => {\n\tconst initialState = {\n\t\ttoken: localStorage.getItem(\"token\"),\n\t\tisAuthenticated: null,\n\t\tloading: true,\n\t\tuser: null,\n\t\terror: null,\n\t};\n\tconst [state, dispatch] = useReducer(authReducer, initialState);\n\t\n\t// Load User\n\tconst loadUser = async () => {\n\t\tif (localStorage.token) {\n\t\t\tsetAuthToken(localStorage.token);\n\t\t}\n\n\t\ttry {\n\t\t\tconst res = await axios.get(\"/api/auth\");\n\n\t\t\tdispatch({\n\t\t\t\ttype: USER_LOADED,\n\t\t\t\tpayload: res.data,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\tdispatch({ type: AUTH_ERROR });\n\t\t}\n\t};\n\n\t// Register User\n\tconst register = async (formData) => {\n\t\tconst config = {\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t};\n\n\t\ttry {\n\t\t\tconst res = await axios.post(\"/api/users\", formData, config);\n\n\t\t\tdispatch({\n\t\t\t\ttype: REGISTER_SUCCESS,\n\t\t\t\tpayload: res.data,\n\t\t\t});\n\n\t\t\tloadUser();\n\t\t} catch (err) {\n\t\t\tdispatch({\n\t\t\t\ttype: REGISTER_FAIL,\n\t\t\t\tpayload: err.response.data.msg,\n\t\t\t});\n\t\t}\n\t};\n\n\t// Login User\n\tconst login = async (formData) => {\n\t\tconst config = {\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t};\n\n\t\ttry {\n\t\t\tconst res = await axios.post(\"/api/auth\", formData, config);\n\n\t\t\tdispatch({\n\t\t\t\ttype: LOGIN_SUCCESS,\n\t\t\t\tpayload: res.data,\n\t\t\t});\n\n\t\t\tloadUser();\n\t\t} catch (err) {\n\t\t\tdispatch({\n\t\t\t\ttype: LOGIN_FAIL,\n\t\t\t\tpayload: err.response.data.msg,\n\t\t\t});\n\t\t}\n\t};\n\n\t// Logout\n\tconst logout = () => {\n\t\tdispatch({ type: LOGOUT })\n\t};\n\n\t// Clear Errors\n\tconst clearErrors = () => {\n\t\tdispatch({ type: CLEAR_ERRORS });\n\t};\n\n\treturn (\n\t\t<AuthContext.Provider\n\t\t\tvalue={{\n\t\t\t\ttoken: state.token,\n\t\t\t\tisAuthenticated: state.isAuthenticated,\n\t\t\t\tloading: state.loading,\n\t\t\t\tuser: state.user,\n\t\t\t\terror: state.error,\n\t\t\t\tregister,\n\t\t\t\tloadUser,\n\t\t\t\tlogin,\n\t\t\t\tlogout,\n\t\t\t\tclearErrors,\n\t\t\t}}\n\t\t>\n\t\t\t{props.children}\n\t\t</AuthContext.Provider>\n\t);\n};\n\nexport default AuthState;\n"]},"metadata":{},"sourceType":"module"}